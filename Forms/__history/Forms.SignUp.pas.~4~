unit Forms.SignUp;

interface

uses
  System.SysUtils, System.Types, System.UITypes, System.Classes, System.Variants,
  FMX.Types, FMX.Controls, FMX.Forms, FMX.Graphics, FMX.Dialogs, FMX.Edit,
  FMX.StdCtrls, FMX.Controls.Presentation,
  FireDAC.Stan.Intf, FireDAC.Stan.Option,
  FireDAC.Stan.Param, FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf,
  FireDAC.DApt.Intf, FireDAC.Stan.Async, FireDAC.DApt, Data.DB,
  FireDAC.Comp.DataSet, FireDAC.Comp.Client, FMX.Layouts, DataModule.MainModule;

type
  TSignUpForm = class(TForm)
    FDQuery1: TFDQuery;
    VertScrollBox1: TVertScrollBox;
    Label1: TLabel;
    Layout1: TLayout;
    Button1: TButton;
    CheckBox1: TCheckBox;
    Label2: TLabel;
    UsernameEdit: TEdit;
    Label3: TLabel;
    PasswordEdit: TEdit;
    Label4: TLabel;
    RepeatPasswordEdit: TEdit;
    Label5: TLabel;
    EmailEdit: TEdit;
    Label6: TLabel;
    TelephoneEdit: TEdit;
    procedure Button1Click(Sender: TObject);
    procedure CheckBox1Change(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
    UsernameIsValid, PasswordIsValid, RepeatPasswordIsValid,
    EmailIsValid, TelephoneIsValid, AcceptTermsIsValid : Boolean;
  end;

var
  SignUpForm: TSignUpForm;

implementation

{$R *.fmx}

uses Forms.Home;

procedure TSignUpForm.Button1Click(Sender: TObject);
begin
    //
    // Salva usuário no banco de dados
    // Save user to database
    var success : Boolean := DataModule1.UserSignUp(UsernameEdit.Text, PasswordEdit.Text, EmailEdit.Text, TelephoneEdit.Text);

    if not success then begin
      // show error message
      ShowMessage('Register of user failed!');
    end else begin
      ShowMessage('User registration successful! Please login.');
      // fecha a janela para retornar para a página principal
        // - ela se incubirá de mostrar os usuários cadastrados para login automático
      // close the window to return to the main page
         // - it will be responsible for showing registered users for automatic login
      self.Close;
    end;
end;

procedure TSignUpForm.CheckBox1Change(Sender: TObject);
begin
    //
  if UsernameIsValid and PasswordIsValid and RepeatPasswordIsValid and
    EmailIsValid and TelephoneIsValid and TCheckBox(Sender).IsChecked then begin
    Button1.Enabled := True;
  end;
    Button1.Enabled := not Button1.Enabled;
end;

end.
